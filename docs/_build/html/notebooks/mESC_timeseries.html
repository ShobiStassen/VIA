<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="6. Using RNA-velocity" href="ViaJupyter_Pancreas_RNAvelocity.html" /><link rel="prev" title="4. Imaging cytometry" href="Imaging%20Cytometry%20%28cell%20cycle%29.html" />

    <!-- Generated with Sphinx 5.1.1 and Furo 2023.03.27 -->
        <title>5. Using time-series metadata (mESC Cytof) - pyvia documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">pyvia  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">pyvia  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pyVia-home.html">StaVia - Multi-Omic Single-Cell Cartography for Spatial and Temporal Atlases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Release%20History.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorial%20Video.html">VIA Tutorial Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Parameters%20and%20Attributes.html">Parameters and Attributes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/pyVIA%20Core.html">pyVIA core</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/Plotting.html">Plotting</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.animate_atlas.html">pyVIA.plotting_via.animate_atlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.animate_streamplot.html">pyVIA.plotting_via.animate_streamplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.get_gene_expression.html">pyVIA.plotting_via.get_gene_expression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.plot_atlas_view.html">pyVIA.plotting_via.plot_atlas_view</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.plot_differentiation_flow.html">pyVIA.plotting_via.plot_differentiation_flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.plot_gene_trend_heatmaps.html">pyVIA.plotting_via.plot_gene_trend_heatmaps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.plot_piechart_viagraph.html">pyVIA.plotting_via.plot_piechart_viagraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.plot_population_composition.html">pyVIA.plotting_via.plot_population_composition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.plot_sc_lineage_probability.html">pyVIA.plotting_via.plot_sc_lineage_probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.plot_scatter.html">pyVIA.plotting_via.plot_scatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.plot_trajectory_curves.html">pyVIA.plotting_via.plot_trajectory_curves</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.plot_viagraph.html">pyVIA.plotting_via.plot_viagraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.via_streamplot.html">pyVIA.plotting_via.via_streamplot</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/Utils.html">Util Functions for plotting</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.make_edgebundle_milestone.html">pyVIA.plotting_via.make_edgebundle_milestone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.via_atlas_emb.html">pyVIA.plotting_via.via_atlas_emb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.via_forcelayout.html">pyVIA.plotting_via.via_forcelayout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.plotting_via/pyVIA.plotting_via.via_mds.html">pyVIA.plotting_via.via_mds</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/Datasets.html">Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.datasets_via/VIA.datasets_via.cell_cycle.html">VIA.datasets_via.cell_cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.datasets_via/VIA.datasets_via.cell_cycle_cyto_data.html">VIA.datasets_via.cell_cycle_cyto_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.datasets_via/VIA.datasets_via.embryoid_body.html">VIA.datasets_via.embryoid_body</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.datasets_via/VIA.datasets_via.scATAC_hematopoiesis.html">VIA.datasets_via.scATAC_hematopoiesis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.datasets_via/VIA.datasets_via.scRNA_hematopoiesis.html">VIA.datasets_via.scRNA_hematopoiesis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.datasets_via/VIA.datasets_via.toy_disconnected.html">VIA.datasets_via.toy_disconnected</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/_autosummary/VIA.datasets_via/VIA.datasets_via.toy_multifurcating.html">VIA.datasets_via.toy_multifurcating</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Basic%20Example%20Code.html">Examples for installation checking</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Via 2.0 Atlas View Gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Atlas%20view%20examples.html">Via2.0 Atlas views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Mouse_to_pup_atlas.html">Large Mouse Embryo to Pup Developmental Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Via2%20Atlas%20Animation.html">Via 2.0 Atlas Animations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Via%20Atlas%20View%20for%20Spatial%20omics.html">Via2.0 Atlas views for Spatial Omics data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Via 2.0 Cartography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Via2.0%20Cartographic%20Mouse%20Gastrualation.html">1. Via 2.0 Cartography on Mouse Gastrulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Zebrahub%20TI%20tutorial.html">2. Via 2.0 Cartography on Zebrahub (Trajectory Inference)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Zebrahub_tutorial_visualization.html">3. Via 2.0 Cartography on Zebrahub (Visualization)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials Via</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ViaJupyter_Toy_Multifurcating.html">1. Basic workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="ViaJupyter_Toy_Disconnected.html">2. Disconnected Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="ViaJupyter_scRNA_Hematopoiesis.html">3. Via Human Hematopoiesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Imaging%20Cytometry%20%28cell%20cycle%29.html">4. Imaging cytometry</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">5. Using time-series metadata (mESC Cytof)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ViaJupyter_Pancreas_RNAvelocity.html">6. Using RNA-velocity</a></li>
<li class="toctree-l1"><a class="reference internal" href="ViaJupyter_scRNAVelocity_hematopoiesis.html">7. Bone marrow with RNA-velocity</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="using-time-series-metadata-mesc-cytof">
<h1>5. Using time-series metadata (mESC Cytof)<a class="headerlink" href="#using-time-series-metadata-mesc-cytof" title="Permalink to this heading"></a></h1>
<p>In many developmental or longitudinal studies, the ages, experimental or developmental times are known. When such sampling point metadata are available, they can prove useful in guiding the graph construction and elucidating downstream analysis.
The bottom of this tutorial shows what happens to the TI and visualization when you do not use the (time-series) sequential information to guide the analysis.</p>
<p>This example uses a mouse embryonic stem cell (mESC) differentiation time course collected with mass cytometry. This particularly example looks at the cells cultured in conditions favouring differentiation into the mesoderm lineage. Samples are collected over an 11 day period.</p>
<section id="load-the-data">
<h2>Load the data<a class="headerlink" href="#load-the-data" title="Permalink to this heading"></a></h2>
<p>The dataset consists of 89782 cells comprising ~ 7000 cells randomly sampled across each time point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scanpy</span> <span class="k">as</span> <span class="nn">sc</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pyVIA.core</span> <span class="k">as</span> <span class="nn">via</span> <span class="c1">#from core_working import *</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/user/Trajectory/Datasets/mESC/mESC_7000perDay_noscaling_meso.csv&#39;</span><span class="p">)</span>

<span class="n">marker_meso</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sca-1&#39;</span><span class="p">,</span> <span class="s1">&#39;CD41&#39;</span><span class="p">,</span> <span class="s1">&#39;Nestin&#39;</span><span class="p">,</span> <span class="s1">&#39;Desmin&#39;</span><span class="p">,</span> <span class="s1">&#39;CD24&#39;</span><span class="p">,</span> <span class="s1">&#39;FoxA2&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct4&#39;</span><span class="p">,</span> <span class="s1">&#39;CD45&#39;</span><span class="p">,</span> <span class="s1">&#39;Ki67&#39;</span><span class="p">,</span> <span class="s1">&#39;Vimentin&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;Cdx2&#39;</span><span class="p">,</span> <span class="s1">&#39;Nanog&#39;</span><span class="p">,</span> <span class="s1">&#39;pStat3-705&#39;</span><span class="p">,</span> <span class="s1">&#39;Sox2&#39;</span><span class="p">,</span> <span class="s1">&#39;Flk-1&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuj1&#39;</span><span class="p">,</span> <span class="s1">&#39;H3K9ac&#39;</span><span class="p">,</span> <span class="s1">&#39;Lin28&#39;</span><span class="p">,</span> <span class="s1">&#39;PDGFRa&#39;</span><span class="p">,</span> <span class="s1">&#39;EpCAM&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;CD44&#39;</span><span class="p">,</span> <span class="s1">&#39;GATA4&#39;</span><span class="p">,</span> <span class="s1">&#39;Klf4&#39;</span><span class="p">,</span> <span class="s1">&#39;CCR9&#39;</span><span class="p">,</span> <span class="s1">&#39;p53&#39;</span><span class="p">,</span> <span class="s1">&#39;SSEA1&#39;</span><span class="p">,</span> <span class="s1">&#39;bCatenin&#39;</span><span class="p">,</span> <span class="s1">&#39;IdU&#39;</span><span class="p">]</span>
<span class="n">true_labels_numeric</span><span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series sampling points (days) </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">true_labels_numeric</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">marker_meso</span><span class="p">]</span> <span class="c1">#using the subset of markers in the original paper</span>

<span class="n">scale_arcsinh</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#commonly used arcsinh transformation for mass cytometry data</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span> <span class="o">/</span> <span class="n">scale_arcsinh</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

<span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">AnnData</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<span class="n">adata</span><span class="o">.</span><span class="n">var_names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;day_str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">true_labels_numeric</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;anndata shape </span><span class="si">{</span><span class="n">adata</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Time series sampling points (days) {0.0, 1.0, 2.0, 2.5, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0}
anndata shape (89782, 28)
</pre></div>
</div>
</div>
</div>
</section>
<section id="initialize-and-run-via">
<h2>Initialize and run VIA<a class="headerlink" href="#initialize-and-run-via" title="Permalink to this heading"></a></h2>
<p>You can play around with the graph-pruning parameters impacting the clustering granularity</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">edgepruning_clustering_resolution</span></code>  (float values between 0-1). larger values larger (but fewer) clusters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">cluster_graph_pruning</span></code> (float values between 0-1) larger values retains more edges/connectivity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">root</span></code> (list) provide the cell index or a group-level label. We know that the initial state is at Day 0.0 so we allow Via to find the location of Day 0.0 cells that best fits an initial cluster. If using a group-level label, it must be an item found in true_label</p></li>
</ul>
<section id="time-series-sequential-metadata-related-paramters">
<h3>Time-series/sequential metadata related paramters<a class="headerlink" href="#time-series-sequential-metadata-related-paramters" title="Permalink to this heading"></a></h3>
<p>In order to guide the trajectory inference with the available time-series labels, we need to set certain parameters.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">time_series</span> <span class="pre">paramter</span> <span class="pre">=</span> <span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_series_labels</span></code> (numeric time-series values of each cell).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">knn_sequential</span></code> to control the level of connectivity with adjacent time points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_diff_step</span></code> (default =2) number of incremental steps of time difference allowed between non-temporally-adjacent edges</p></li>
</ul>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">true_label</span></code> parameter is purely for reference when available (based on clustering annotations or can be omitted) and does not impact the TI except for allowing you to color-code cells in later visualizations based on any labels you have. If you don’t provide a true_label parameter, Via just generates a dummy set of labels and the TI computations will remain unchanged. Of course in this case, you would not be able to assign a group-level root_user since that would have to correspond to a true_label and instead you can allow random or rna-velocity guided root selection or choose a cell index (int).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn</span><span class="o">=</span><span class="mi">40</span>
<span class="n">cluster_graph_pruning</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">edgepruning_clustering_resolution</span><span class="o">=</span><span class="mf">0.3</span>
<span class="n">random_seed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">knn_sequential</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">root</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="c1">#since the root corresponds to a group level initial state  we set dataset = &#39;group&#39;</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">via</span><span class="o">.</span><span class="n">VIA</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">true_label</span><span class="o">=</span><span class="n">true_labels_numeric</span><span class="p">,</span> <span class="n">edgepruning_clustering_resolution</span><span class="o">=</span><span class="n">edgepruning_clustering_resolution</span><span class="p">,</span> <span class="n">edgepruning_clustering_resolution_local</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">knn</span><span class="o">=</span><span class="n">knn</span><span class="p">,</span>
         <span class="n">cluster_graph_pruning</span><span class="o">=</span><span class="n">cluster_graph_pruning</span><span class="p">,</span>  <span class="n">piegraph_arrow_head_width</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
         <span class="n">too_big_factor</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">resolution_parameter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">root_user</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="n">random_seed</span><span class="p">,</span>
         <span class="n">is_coarse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">preserve_disconnected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pseudotime_threshold_TS</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">x_lazy</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
         <span class="n">alpha_teleport</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">time_series</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">time_series_labels</span><span class="o">=</span><span class="n">true_labels_numeric</span><span class="p">,</span> <span class="n">t_diff_step</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
         <span class="n">edgebundle_pruning_twice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">knn_sequential</span><span class="o">=</span><span class="n">knn_sequential</span><span class="p">,</span> <span class="n">knn_sequential_reverse</span><span class="o">=</span><span class="n">knn_sequential</span><span class="p">)</span>
<span class="n">v0</span><span class="o">.</span><span class="n">run_VIA</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-10-10 14:59:52.060765	Running VIA over input data of 89782 (samples) x 28 (features)
2023-10-10 14:59:52.061403	Knngraph has 40 neighbors
2023-10-10 15:00:09.377507	Using time series information to guide knn graph construction 
2023-10-10 15:00:09.384511	Time series ordered set [0.0, 1.0, 2.0, 2.5, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0]
2023-10-10 15:01:17.441564	Shape neighbors (89782, 40) and sequential neighbors (89782, 40)
2023-10-10 15:01:17.477229	Shape augmented neighbors (89782, 80)
2023-10-10 15:01:17.501867	Actual average allowable time difference between nodes is 1.8333
2023-10-10 15:01:38.278760	Finished global pruning of 40-knn graph used for clustering at level of 0.3. Kept 55.2 % of edges. 
2023-10-10 15:01:38.382642	Number of connected components used for clustergraph  is 1
2023-10-10 15:01:51.584327	Commencing community detection
2023-10-10 15:01:56.752912	Finished running Leiden algorithm. Found 24 clusters.
2023-10-10 15:01:56.778275	Merging 8 very small clusters (&lt;10)
2023-10-10 15:01:56.799450	Finished detecting communities. Found 16 communities
2023-10-10 15:01:56.804725	Making cluster graph. Global cluster graph pruning level: 0.15
2023-10-10 15:01:57.656587	Graph has 1 connected components before pruning
2023-10-10 15:01:57.658554	Graph has 1 connected components after pruning
2023-10-10 15:01:57.658698	Graph has 1 connected components after reconnecting
2023-10-10 15:01:57.659182	0.0% links trimmed from local pruning relative to start
2023-10-10 15:01:57.659200	72.0% links trimmed from global pruning relative to start
2023-10-10 15:01:57.667250	component number 0 out of  [0]
2023-10-10 15:01:57.713696	group root method
2023-10-10 15:01:57.713735	for component 0, the root is 0.0 and ri 0.0
cluster 0 has majority 7.0
cluster 1 has majority 10.0
2023-10-10 15:01:57.827243	New root is 1 and majority 10.0
cluster 2 has majority 9.0
cluster 3 has majority 2.5
cluster 4 has majority 3.0
cluster 5 has majority 5.0
cluster 6 has majority 1.0
cluster 7 has majority 6.0
cluster 8 has majority 2.0
cluster 9 has majority 0.0
2023-10-10 15:01:57.872835	New root is 9 and majority 0.0
cluster 10 has majority 4.0
cluster 11 has majority 8.0
cluster 12 has majority 9.0
cluster 13 has majority 0.0
cluster 14 has majority 2.5
cluster 15 has majority 5.0
2023-10-10 15:01:57.900203	Computing lazy-teleporting expected hitting times
2023-10-10 15:01:58.279998	 ended all multiprocesses, will retrieve and reshape
try rw2 hitting times setup
start computing walks with rw2 method
g.indptr.size, 17
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/pecanpy/graph.py:90: UserWarning: WARNING: Implicitly set node IDs to the canonical node ordering due to missing IDs field in the raw CSR npz file. This warning message can be suppressed by setting implicit_ids to True in the read_npz function call, or by setting the --implicit_ids flag in the CLI
  warnings.warn(
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "1cefe637346f48599b068440ebbe92a2"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>memory for rw2 hittings times  2. Using rw2 based pt
do scaling of pt
2023-10-10 15:02:01.110005	Identifying terminal clusters corresponding to unique lineages...
2023-10-10 15:02:01.110035	Closeness:[1, 2, 9, 11, 12, 13]
2023-10-10 15:02:01.110046	Betweenness:[1, 2, 6, 7, 8, 9, 12, 13, 15]
2023-10-10 15:02:01.110053	Out Degree:[1, 2, 3, 4, 9, 10, 11, 12, 13, 14, 15]
2023-10-10 15:02:01.110263	Cluster 1 had 3 or more neighboring terminal states [2, 11, 12] and so we removed cluster 11
2023-10-10 15:02:01.110421	Terminal clusters corresponding to unique lineages in this component are [1, 2, 12, 15] 
TESTING rw2_lineage probability at memory 5
testing rw2 lineage probability at memory 5
g.indptr.size, 17
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/pecanpy/graph.py:90: UserWarning: WARNING: Implicitly set node IDs to the canonical node ordering due to missing IDs field in the raw CSR npz file. This warning message can be suppressed by setting implicit_ids to True in the read_npz function call, or by setting the --implicit_ids flag in the CLI
  warnings.warn(
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "04c2741582fe4bcabba8ed35590314cd"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-10-10 15:02:03.743076	 Cluster or terminal cell fate 1 is reached 188.0 times
2023-10-10 15:02:03.773171	 Cluster or terminal cell fate 2 is reached 168.0 times
2023-10-10 15:02:03.801709	 Cluster or terminal cell fate 12 is reached 187.0 times
2023-10-10 15:02:03.827094	 Cluster or terminal cell fate 15 is reached 821.0 times
2023-10-10 15:02:03.850863	There are (4) terminal clusters corresponding to unique lineages {1: 10.0, 2: 9.0, 12: 9.0, 15: 5.0}
2023-10-10 15:02:03.850908	Begin projection of pseudotime and lineage likelihood
2023-10-10 15:02:08.218722	Start reading data
2023-10-10 15:02:08.218789	Correlation of Via pseudotime with developmental stage 92.75 %
2023-10-10 15:02:08.229551	Cluster graph layout based on forward biasing
2023-10-10 15:02:08.230564	Starting make edgebundle viagraph...
2023-10-10 15:02:08.230584	Make via clustergraph edgebundle
2023-10-10 15:02:08.407972	Hammer dims: Nodes shape: (16, 2) Edges shape: (66, 3)
2023-10-10 15:02:08.409930	Graph has 1 connected components before pruning
2023-10-10 15:02:08.413890	Graph has 5 connected components after pruning
2023-10-10 15:02:08.422069	Graph has 1 connected components after reconnecting
2023-10-10 15:02:08.423018	51.5% links trimmed from local pruning relative to start
2023-10-10 15:02:08.423055	75.8% links trimmed from global pruning relative to start
2023-10-10 15:02:08.492411	Time elapsed 122.2 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/scipy/sparse/_index.py:103: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
  self._set_intXint(row, col, x.flat[0])
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-viagraph">
<h3>Plot the viagraph<a class="headerlink" href="#plot-the-viagraph" title="Permalink to this heading"></a></h3>
<p>Note that the clusters circled in red correspond to the identified (predicted) terminal fates and since we know the time-samples, we can see they correspond to cells in the final stages of development from Day 10-11.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">via</span><span class="o">.</span><span class="n">plot_piechart_viagraph</span><span class="p">(</span><span class="n">via_object</span><span class="o">=</span><span class="n">v0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/pyVIA/plotting_via.py:3092: UserWarning: No data for colormapping provided via &#39;c&#39;. Parameters &#39;cmap&#39; will be ignored
  sct = ax.scatter(node_pos[:, 0], node_pos[:, 1],
</pre></div>
</div>
<img alt="../_images/d6253cac2b161273bbbe26c7b8b4ccafe728d6cb339522b4ffe344c50d0e7de1.png" src="../_images/d6253cac2b161273bbbe26c7b8b4ccafe728d6cb339522b4ffe344c50d0e7de1.png" />
</div>
</div>
</section>
<section id="protein-marker-dynamics">
<h3>Protein Marker Dynamics<a class="headerlink" href="#protein-marker-dynamics" title="Permalink to this heading"></a></h3>
<p>We expect the lineages associated with the differentiated mesoderm cells(Day 10/11 cells) to show an increase in <em>Cd44, gata4</em> and <em>pdgfra</em> and a decrease in <em>Epcam</em>
The Epcam high Lineage from Cluster 15 actually contains several day 9/10 cells</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">marker_genes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CD44&#39;</span><span class="p">,</span> <span class="s1">&#39;GATA4&#39;</span><span class="p">,</span> <span class="s1">&#39;PDGFRa&#39;</span><span class="p">,</span> <span class="s1">&#39;EpCAM&#39;</span><span class="p">]</span>
<span class="n">df_genes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">adata</span><span class="p">[:,</span> <span class="n">marker_genes</span><span class="p">]</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
<span class="n">df_genes</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">marker_genes</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span> <span class="n">via</span><span class="o">.</span><span class="n">get_gene_expression</span><span class="p">(</span><span class="n">via_object</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span><span class="n">gene_exp</span><span class="o">=</span><span class="n">df_genes</span><span class="p">,</span> <span class="n">spline_order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_splines</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/391e4dcd6717dffa03b9188ae4fd5677c254ef3b1ce8565e478f2154a0529fb0.png" src="../_images/391e4dcd6717dffa03b9188ae4fd5677c254ef3b1ce8565e478f2154a0529fb0.png" />
</div>
</div>
</section>
<section id="the-atlas-embedding">
<h3>The Atlas Embedding<a class="headerlink" href="#the-atlas-embedding" title="Permalink to this heading"></a></h3>
<p>We use the knn-graph constructed in VIA which incorporates the sequential information in order to generate a 2D embedding of the data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atlas_embedding</span> <span class="o">=</span> <span class="n">via</span><span class="o">.</span><span class="n">via_atlas_emb</span><span class="p">(</span><span class="n">via_object</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">min_dist</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">init_pos</span><span class="o">=</span><span class="s1">&#39;via&#39;</span><span class="p">)</span>
    <span class="c1">#via.run_atlas_emb(vi, graph=v0.csr_full_graph, n_components=2, spread=1.0, min_dist=0.3,                  init_pos=&#39;spectral&#39;, random_state=1, n_epochs=150))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-input (89782, 28)
len membership and n_cells 89782 89782
n cell 89782
2023-10-10 15:03:03.170901	Computing embedding on sc-Viagraph
2023-10-10 15:03:03.235140	using via cluster graph to initialize embedding
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "8331ccfc96c44a5dbd792ea8bfe9a023"}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">via</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">embedding</span><span class="o">=</span><span class="n">atlas_embedding</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span> <span class="n">true_labels_numeric</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
</pre></div>
</div>
<img alt="../_images/db4a60a269a38776bf1fb4599d7a0a909771b3d7ac8d309ffb2bda7bebe6ff2e.png" src="../_images/db4a60a269a38776bf1fb4599d7a0a909771b3d7ac8d309ffb2bda7bebe6ff2e.png" />
</div>
</div>
</section>
<section id="streamplots-for-cytof-data">
<h3>Streamplots for Cytof data<a class="headerlink" href="#streamplots-for-cytof-data" title="Permalink to this heading"></a></h3>
<p>The cluster-level trajectory is projected onto the 2D embedding to visualize the more fine-grained progression</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">via</span><span class="o">.</span><span class="n">via_streamplot</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">atlas_embedding</span><span class="p">,</span> <span class="n">scatter_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">scatter_alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">marker_edgewidth</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                  <span class="n">density_stream</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">density_grid</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">smooth_transition</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">smooth_grid</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/scipy/sparse/_index.py:146: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
  self._set_arrayXarray(i, j, x)
/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/pyVIA/core.py:1287: RuntimeWarning: divide by zero encountered in divide
  T = T.multiply(csr_matrix(1.0 / np.abs(T).sum(1)))  # rows sum to one
/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/pyVIA/core.py:1318: RuntimeWarning: Mean of empty slice.
  V_emb[i] = probs.dot(dX) - probs.mean() * dX.sum(0)
/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/numpy/core/_methods.py:192: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
</pre></div>
</div>
<img alt="../_images/56f2b3f8a2997e17217ef4e52b8e36b216b4bafd9e3dc36c504ebaba62953945.png" src="../_images/56f2b3f8a2997e17217ef4e52b8e36b216b4bafd9e3dc36c504ebaba62953945.png" />
</div>
</div>
</section>
<section id="draw-the-atlas-view-with-connectivities">
<h3>Draw The Atlas View with connectivities<a class="headerlink" href="#draw-the-atlas-view-with-connectivities" title="Permalink to this heading"></a></h3>
<p>A visualization unique to Via that combines the high-resolution edge and single-cell layouts</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v0</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">atlas_embedding</span>
<span class="n">f</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">via</span><span class="o">.</span><span class="n">plot_atlas_view</span><span class="p">(</span><span class="n">via_object</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span><span class="n">n_milestones</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">sc_labels_expression</span><span class="o">=</span><span class="n">true_labels_numeric</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-10-10 15:14:30.048319	Computing Edges
2023-10-10 15:14:30.048365	Start finding milestones
2023-10-10 15:14:47.168789	End milestones with 200
2023-10-10 15:14:48.656038	Recompute weights
2023-10-10 15:14:48.713622	pruning milestone graph based on recomputed weights
2023-10-10 15:14:48.715549	Graph has 1 connected components before pruning
2023-10-10 15:14:48.716435	Graph has 1 connected components after pruning
2023-10-10 15:14:48.716688	Graph has 1 connected components after reconnecting
2023-10-10 15:14:48.719559	regenerate igraph on pruned edges
2023-10-10 15:14:48.766860	Setting numeric label as time_series_labels or other sequential metadata for coloring edges
2023-10-10 15:14:49.010023	Making smooth edges
inside add sc embedding second if
</pre></div>
</div>
<img alt="../_images/7a204dd673d9c74b5233cf2002b71bb0ac617985d14f6a129d46d6408c552c90.png" src="../_images/7a204dd673d9c74b5233cf2002b71bb0ac617985d14f6a129d46d6408c552c90.png" />
</div>
</div>
</section>
<section id="terminal-states-and-pathways">
<h3>Terminal states and pathways<a class="headerlink" href="#terminal-states-and-pathways" title="Permalink to this heading"></a></h3>
<p>The high-level direction from root to different final states is shown here. The final states are marked in yellow</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">via</span><span class="o">.</span><span class="n">plot_trajectory_curves</span><span class="p">(</span><span class="n">via_object</span><span class="o">=</span><span class="n">v0</span><span class="p">,</span> <span class="n">draw_all_curves</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1">#Setting &#39;draw_all_curves&#39; to False helps highlight major pathways</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100% (11 of 11) |########################| Elapsed Time: 0:00:00 Time:  0:00:00
100% (11 of 11) |########################| Elapsed Time: 0:00:00 Time:  0:00:00
100% (11 of 11) |########################| Elapsed Time: 0:00:00 Time:  0:00:00
100% (11 of 11) |########################| Elapsed Time: 0:00:00 Time:  0:00:00
100% (11 of 11) |########################| Elapsed Time: 0:00:00 Time:  0:00:00
100% (11 of 11) |########################| Elapsed Time: 0:00:00 Time:  0:00:00
100% (11 of 11) |########################| Elapsed Time: 0:00:00 Time:  0:00:00
100% (11 of 11) |########################| Elapsed Time: 0:00:00 Time:  0:00:00
100% (11 of 11) |########################| Elapsed Time: 0:00:00 Time:  0:00:00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-10-10 15:19:22.164658	Super cluster 1 is a super terminal with sub_terminal cluster 1
2023-10-10 15:19:22.166815	Super cluster 2 is a super terminal with sub_terminal cluster 2
2023-10-10 15:19:22.166871	Super cluster 12 is a super terminal with sub_terminal cluster 12
2023-10-10 15:19:22.166903	Super cluster 15 is a super terminal with sub_terminal cluster 15
</pre></div>
</div>
<img alt="../_images/6480d8c429c111849807443432bd86d06feab86456aa4bc45ad89852133c8938.png" src="../_images/6480d8c429c111849807443432bd86d06feab86456aa4bc45ad89852133c8938.png" />
</div>
</div>
</section>
<section id="animated-trajectory">
<h3>Animated Trajectory<a class="headerlink" href="#animated-trajectory" title="Permalink to this heading"></a></h3>
<p>Fine grained vector fields in action</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">via</span><span class="o">.</span><span class="n">animate_streamplot</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">atlas_embedding</span><span class="p">,</span><span class="n">saveto</span><span class="o">=</span><span class="s1">&#39;/home/user/Trajectory/Datasets/mESC/mesc_timeseries_stream_animation_oct2023.gif&#39;</span><span class="p">)</span> <span class="c1">#saveto=&#39;.../filename.gif&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/pyVIA/core.py:1318: RuntimeWarning: Mean of empty slice.
  V_emb[i] = probs.dot(dX) - probs.mean() * dX.sum(0)
/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/numpy/core/_methods.py:192: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-10-10 15:50:11.443156	Inside animated. File will be saved to location /home/user/Trajectory/Datasets/mESC/mesc_timeseries_stream_animation_oct2023.gif
total number of stream lines 410
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/250 [00:00&lt;?, ?it/s]
MovieWriter imagemagick unavailable; using Pillow instead.
</pre></div>
</div>
<img alt="../_images/f61bd4bb549102f94f75ac1758c5651e1f16745cb2fdb16ae7dcd653b5a0fe1c.png" src="../_images/f61bd4bb549102f94f75ac1758c5651e1f16745cb2fdb16ae7dcd653b5a0fe1c.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;Axes: &gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/home/user/Trajectory/Datasets/mESC/mesc_timeseries_stream_animation_oct2023.gif&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9c8a9dc57162b0384bc8097ed4551005a4f39a6a4671d736bd7519b81c35399f.png" src="../_images/9c8a9dc57162b0384bc8097ed4551005a4f39a6a4671d736bd7519b81c35399f.png" />
</div>
</div>
</section>
</section>
<section id="not-using-time-series-data-to-guide-the-analysis">
<h2>Not using time-series data to guide the analysis<a class="headerlink" href="#not-using-time-series-data-to-guide-the-analysis" title="Permalink to this heading"></a></h2>
<p>When choosing not to use the available experimental time-stamps, we see that the overall Trajectory is more difficult to interpret and chronology is less clear (as seen when plotting the viagraph below)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn</span><span class="o">=</span><span class="mi">40</span>
<span class="n">cluster_graph_pruning</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">edgepruning_clustering_resolution</span><span class="o">=</span><span class="mf">0.3</span>
<span class="n">random_seed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">root</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="c1">#since the root corresponds to a group level initial state  we set dataset = &#39;group&#39;</span>

<span class="n">v_notime</span> <span class="o">=</span> <span class="n">via</span><span class="o">.</span><span class="n">VIA</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">true_label</span><span class="o">=</span><span class="n">true_labels_numeric</span><span class="p">,</span> <span class="n">edgepruning_clustering_resolution</span><span class="o">=</span><span class="n">edgepruning_clustering_resolution</span><span class="p">,</span> <span class="n">edgepruning_clustering_resolution_local</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">knn</span><span class="o">=</span><span class="n">knn</span><span class="p">,</span>
         <span class="n">cluster_graph_pruning</span><span class="o">=</span><span class="n">cluster_graph_pruning</span><span class="p">,</span>  <span class="n">piegraph_arrow_head_width</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
         <span class="n">too_big_factor</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">resolution_parameter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">root_user</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="n">random_seed</span><span class="p">,</span>
         <span class="n">is_coarse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">preserve_disconnected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pseudotime_threshold_TS</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">x_lazy</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
         <span class="n">alpha_teleport</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
<span class="n">v_notime</span><span class="o">.</span><span class="n">run_VIA</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-10-10 17:22:51.827898	Running VIA over input data of 89782 (samples) x 28 (features)
2023-10-10 17:22:51.827943	Knngraph has 40 neighbors
2023-10-10 17:23:32.546462	Finished global pruning of 40-knn graph used for clustering at level of 0.3. Kept 55.2 % of edges. 
2023-10-10 17:23:33.360124	Number of connected components used for clustergraph  is 1
2023-10-10 17:23:42.945437	Commencing community detection
2023-10-10 17:23:48.961073	Finished running Leiden algorithm. Found 24 clusters.
2023-10-10 17:23:49.031375	Merging 8 very small clusters (&lt;10)
2023-10-10 17:23:49.047839	Finished detecting communities. Found 16 communities
2023-10-10 17:23:49.053183	Making cluster graph. Global cluster graph pruning level: 0.15
2023-10-10 17:23:49.514431	Graph has 1 connected components before pruning
2023-10-10 17:23:49.520669	Graph has 1 connected components after pruning
2023-10-10 17:23:49.521053	Graph has 1 connected components after reconnecting
2023-10-10 17:23:49.521919	0.0% links trimmed from local pruning relative to start
2023-10-10 17:23:49.521948	69.8% links trimmed from global pruning relative to start
2023-10-10 17:23:49.543246	component number 0 out of  [0]
2023-10-10 17:23:49.637670	group root method
2023-10-10 17:23:49.637712	for component 0, the root is 0.0 and ri 0.0
cluster 0 has majority 7.0
cluster 1 has majority 10.0
2023-10-10 17:23:49.858094	New root is 1 and majority 10.0
cluster 2 has majority 9.0
cluster 3 has majority 2.5
cluster 4 has majority 3.0
cluster 5 has majority 5.0
cluster 6 has majority 1.0
cluster 7 has majority 6.0
cluster 8 has majority 2.0
cluster 9 has majority 0.0
2023-10-10 17:23:49.934760	New root is 9 and majority 0.0
cluster 10 has majority 4.0
cluster 11 has majority 8.0
cluster 12 has majority 9.0
cluster 13 has majority 0.0
cluster 14 has majority 2.5
cluster 15 has majority 5.0
2023-10-10 17:23:49.978782	Computing lazy-teleporting expected hitting times
2023-10-10 17:23:50.514672	 ended all multiprocesses, will retrieve and reshape
try rw2 hitting times setup
start computing walks with rw2 method
g.indptr.size, 17
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/pecanpy/graph.py:90: UserWarning: WARNING: Implicitly set node IDs to the canonical node ordering due to missing IDs field in the raw CSR npz file. This warning message can be suppressed by setting implicit_ids to True in the read_npz function call, or by setting the --implicit_ids flag in the CLI
  warnings.warn(
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "5d5f27516eac477a99f9f7cea2ff3d61"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>memory for rw2 hittings times  2. Using rw2 based pt
do scaling of pt
2023-10-10 17:23:54.358993	Identifying terminal clusters corresponding to unique lineages...
2023-10-10 17:23:54.359042	Closeness:[1, 4, 5, 9, 10, 13]
2023-10-10 17:23:54.359053	Betweenness:[1, 4, 5, 7, 8, 9, 10, 13]
2023-10-10 17:23:54.359059	Out Degree:[1, 2, 4, 5, 9, 10, 12, 13, 15]
2023-10-10 17:23:54.359431	Terminal clusters corresponding to unique lineages in this component are [1, 10, 5] 
TESTING rw2_lineage probability at memory 5
testing rw2 lineage probability at memory 5
g.indptr.size, 17
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/pecanpy/graph.py:90: UserWarning: WARNING: Implicitly set node IDs to the canonical node ordering due to missing IDs field in the raw CSR npz file. This warning message can be suppressed by setting implicit_ids to True in the read_npz function call, or by setting the --implicit_ids flag in the CLI
  warnings.warn(
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "fc37859eb720440ab9487ff3ef49d2b1"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-10-10 17:23:57.703638	 Cluster or terminal cell fate 1 is reached 223.0 times
2023-10-10 17:23:57.741600	 Cluster or terminal cell fate 10 is reached 606.0 times
2023-10-10 17:23:57.770042	 Cluster or terminal cell fate 5 is reached 997.0 times
2023-10-10 17:23:57.790720	There are (3) terminal clusters corresponding to unique lineages {1: 10.0, 10: 4.0, 5: 5.0}
2023-10-10 17:23:57.790771	Begin projection of pseudotime and lineage likelihood
2023-10-10 17:24:02.856437	Cluster graph layout based on forward biasing
2023-10-10 17:24:02.857501	Starting make edgebundle viagraph...
2023-10-10 17:24:02.857518	Make via clustergraph edgebundle
2023-10-10 17:24:03.108995	Hammer dims: Nodes shape: (16, 2) Edges shape: (70, 3)
2023-10-10 17:24:03.112835	Graph has 1 connected components before pruning
2023-10-10 17:24:03.118067	Graph has 7 connected components after pruning
2023-10-10 17:24:03.129269	Graph has 1 connected components after reconnecting
2023-10-10 17:24:03.129927	55.7% links trimmed from local pruning relative to start
2023-10-10 17:24:03.129956	72.9% links trimmed from global pruning relative to start
2023-10-10 17:24:03.215031	Time elapsed 56.7 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/scipy/sparse/_index.py:103: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
  self._set_intXint(row, col, x.flat[0])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">via</span><span class="o">.</span><span class="n">plot_piechart_viagraph</span><span class="p">(</span><span class="n">via_object</span><span class="o">=</span><span class="n">v_notime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/user/anaconda3/envs/Via2Env_py10/lib/python3.10/site-packages/pyVIA/plotting_via.py:3092: UserWarning: No data for colormapping provided via &#39;c&#39;. Parameters &#39;cmap&#39; will be ignored
  sct = ax.scatter(node_pos[:, 0], node_pos[:, 1],
</pre></div>
</div>
<img alt="../_images/bb6ecf5ca5b04f24a249383c7d28b4249c310891016ba88714efd261f45f15da.png" src="../_images/bb6ecf5ca5b04f24a249383c7d28b4249c310891016ba88714efd261f45f15da.png" />
</div>
</div>
<section id="using-umap-instead-of-via-s-cartographic-embeddings">
<h3>Using UMAP instead of Via’s cartographic embeddings<a class="headerlink" href="#using-umap-instead-of-via-s-cartographic-embeddings" title="Permalink to this heading"></a></h3>
<p>As shown below, if once uses UMAP instead of the TI adjusted embedding from Via, then the early and late stages are disconnected</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">umap</span>
<span class="n">embedding_umap</span> <span class="o">=</span> <span class="n">umap</span><span class="o">.</span><span class="n">UMAP</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;spectral&#39;</span><span class="p">,</span> <span class="n">min_dist</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">via</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">embedding</span><span class="o">=</span><span class="n">embedding_umap</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">true_labels_numeric</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
</pre></div>
</div>
<img alt="../_images/ede130191a0e1238a4772d09c01d5cac0a4298e1172ec668a652ded1e63c2f90.png" src="../_images/ede130191a0e1238a4772d09c01d5cac0a4298e1172ec668a652ded1e63c2f90.png" />
</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="ViaJupyter_Pancreas_RNAvelocity.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">6. Using RNA-velocity</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Imaging%20Cytometry%20%28cell%20cycle%29.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">4. Imaging cytometry</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, shobana stassen
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">5. Using time-series metadata (mESC Cytof)</a><ul>
<li><a class="reference internal" href="#load-the-data">Load the data</a></li>
<li><a class="reference internal" href="#initialize-and-run-via">Initialize and run VIA</a><ul>
<li><a class="reference internal" href="#time-series-sequential-metadata-related-paramters">Time-series/sequential metadata related paramters</a></li>
<li><a class="reference internal" href="#plot-the-viagraph">Plot the viagraph</a></li>
<li><a class="reference internal" href="#protein-marker-dynamics">Protein Marker Dynamics</a></li>
<li><a class="reference internal" href="#the-atlas-embedding">The Atlas Embedding</a></li>
<li><a class="reference internal" href="#streamplots-for-cytof-data">Streamplots for Cytof data</a></li>
<li><a class="reference internal" href="#draw-the-atlas-view-with-connectivities">Draw The Atlas View with connectivities</a></li>
<li><a class="reference internal" href="#terminal-states-and-pathways">Terminal states and pathways</a></li>
<li><a class="reference internal" href="#animated-trajectory">Animated Trajectory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#not-using-time-series-data-to-guide-the-analysis">Not using time-series data to guide the analysis</a><ul>
<li><a class="reference internal" href="#using-umap-instead-of-via-s-cartographic-embeddings">Using UMAP instead of Via’s cartographic embeddings</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script defer="defer" src="https://unpkg.com/@popperjs/core@2"></script>
    <script defer="defer" src="https://unpkg.com/tippy.js@6"></script>
    <script defer="defer" src="../_static/tippy\notebooks\mESC_timeseries.38d5f371-5027-4f36-a97f-9525651031d7.js"></script>
    </body>
</html>